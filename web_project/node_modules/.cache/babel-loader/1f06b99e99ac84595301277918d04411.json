{"ast":null,"code":"/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../../lib');\n\nvar Color = require('../../../components/color');\n\nvar Registry = require('../../../registry');\n\nvar handleSubplotDefaults = require('../../subplot_defaults');\n\nvar supplyGl3dAxisLayoutDefaults = require('./axis_defaults');\n\nvar layoutAttributes = require('./layout_attributes');\n\nvar getSubplotData = require('../../get_data').getSubplotData;\n\nvar GL3D = 'gl3d';\n\nmodule.exports = function supplyLayoutDefaults(layoutIn, layoutOut, fullData) {\n  var hasNon3D = layoutOut._basePlotModules.length > 1; // some layout-wide attribute are used in all scenes\n  // if 3D is the only visible plot type\n\n  function getDfltFromLayout(attr) {\n    if (hasNon3D) return;\n    var isValid = Lib.validate(layoutIn[attr], layoutAttributes[attr]);\n    if (isValid) return layoutIn[attr];\n  }\n\n  handleSubplotDefaults(layoutIn, layoutOut, fullData, {\n    type: GL3D,\n    attributes: layoutAttributes,\n    handleDefaults: handleGl3dDefaults,\n    fullLayout: layoutOut,\n    font: layoutOut.font,\n    fullData: fullData,\n    getDfltFromLayout: getDfltFromLayout,\n    paper_bgcolor: layoutOut.paper_bgcolor,\n    calendar: layoutOut.calendar\n  });\n};\n\nfunction handleGl3dDefaults(sceneLayoutIn, sceneLayoutOut, coerce, opts) {\n  /*\n   * Scene numbering proceeds as follows\n   * scene\n   * scene2\n   * scene3\n   *\n   * and d.scene will be undefined or some number or number string\n   *\n   * Also write back a blank scene object to user layout so that some\n   * attributes like aspectratio can be written back dynamically.\n   */\n  var bgcolor = coerce('bgcolor');\n  var bgColorCombined = Color.combine(bgcolor, opts.paper_bgcolor);\n  var cameraKeys = ['up', 'center', 'eye'];\n\n  for (var j = 0; j < cameraKeys.length; j++) {\n    coerce('camera.' + cameraKeys[j] + '.x');\n    coerce('camera.' + cameraKeys[j] + '.y');\n    coerce('camera.' + cameraKeys[j] + '.z');\n  }\n\n  coerce('camera.projection.type');\n  /*\n   * coerce to positive number (min 0) but also do not accept 0 (>0 not >=0)\n   * note that 0's go false with the !! call\n   */\n\n  var hasAspect = !!coerce('aspectratio.x') && !!coerce('aspectratio.y') && !!coerce('aspectratio.z');\n  var defaultAspectMode = hasAspect ? 'manual' : 'auto';\n  var aspectMode = coerce('aspectmode', defaultAspectMode);\n  /*\n   * We need aspectratio object in all the Layouts as it is dynamically set\n   * in the calculation steps, ie, we cant set the correct data now, it happens later.\n   * We must also account for the case the user sends bad ratio data with 'manual' set\n   * for the mode. In this case we must force change it here as the default coerce\n   * misses it above.\n   */\n\n  if (!hasAspect) {\n    sceneLayoutIn.aspectratio = sceneLayoutOut.aspectratio = {\n      x: 1,\n      y: 1,\n      z: 1\n    };\n    if (aspectMode === 'manual') sceneLayoutOut.aspectmode = 'auto';\n    /*\n     * kind of like autorange - we need the calculated aspectmode back in\n     * the input layout or relayout can cause problems later\n     */\n\n    sceneLayoutIn.aspectmode = sceneLayoutOut.aspectmode;\n  }\n\n  var fullGl3dData = getSubplotData(opts.fullData, GL3D, opts.id);\n  supplyGl3dAxisLayoutDefaults(sceneLayoutIn, sceneLayoutOut, {\n    font: opts.font,\n    scene: opts.id,\n    data: fullGl3dData,\n    bgColor: bgColorCombined,\n    calendar: opts.calendar,\n    fullLayout: opts.fullLayout\n  });\n  Registry.getComponentMethod('annotations3d', 'handleDefaults')(sceneLayoutIn, sceneLayoutOut, opts);\n  var dragmode = opts.getDfltFromLayout('dragmode');\n\n  if (dragmode !== false) {\n    if (!dragmode) {\n      dragmode = 'orbit';\n\n      if (sceneLayoutIn.camera && sceneLayoutIn.camera.up) {\n        var x = sceneLayoutIn.camera.up.x;\n        var y = sceneLayoutIn.camera.up.y;\n        var z = sceneLayoutIn.camera.up.z;\n\n        if (z !== 0) {\n          if (!x || !y || !z) {\n            dragmode = 'turntable';\n          } else if (z / Math.sqrt(x * x + y * y + z * z) > 0.999) {\n            dragmode = 'turntable';\n          }\n        }\n      } else {\n        dragmode = 'turntable';\n      }\n    }\n  }\n\n  coerce('dragmode', dragmode);\n  coerce('hovermode', opts.getDfltFromLayout('hovermode'));\n}","map":{"version":3,"sources":["/Users/jingkaisu/Documents/HRfront/HalliganReviews/web_project/node_modules/plotly.js/src/plots/gl3d/layout/defaults.js"],"names":["Lib","require","Color","Registry","handleSubplotDefaults","supplyGl3dAxisLayoutDefaults","layoutAttributes","getSubplotData","GL3D","module","exports","supplyLayoutDefaults","layoutIn","layoutOut","fullData","hasNon3D","_basePlotModules","length","getDfltFromLayout","attr","isValid","validate","type","attributes","handleDefaults","handleGl3dDefaults","fullLayout","font","paper_bgcolor","calendar","sceneLayoutIn","sceneLayoutOut","coerce","opts","bgcolor","bgColorCombined","combine","cameraKeys","j","hasAspect","defaultAspectMode","aspectMode","aspectratio","x","y","z","aspectmode","fullGl3dData","id","scene","data","bgColor","getComponentMethod","dragmode","camera","up","Math","sqrt"],"mappings":"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","sourcesContent":["/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n\n\n'use strict';\n\nvar Lib = require('../../../lib');\nvar Color = require('../../../components/color');\nvar Registry = require('../../../registry');\n\nvar handleSubplotDefaults = require('../../subplot_defaults');\nvar supplyGl3dAxisLayoutDefaults = require('./axis_defaults');\nvar layoutAttributes = require('./layout_attributes');\nvar getSubplotData = require('../../get_data').getSubplotData;\n\nvar GL3D = 'gl3d';\n\nmodule.exports = function supplyLayoutDefaults(layoutIn, layoutOut, fullData) {\n    var hasNon3D = layoutOut._basePlotModules.length > 1;\n\n    // some layout-wide attribute are used in all scenes\n    // if 3D is the only visible plot type\n    function getDfltFromLayout(attr) {\n        if(hasNon3D) return;\n\n        var isValid = Lib.validate(layoutIn[attr], layoutAttributes[attr]);\n        if(isValid) return layoutIn[attr];\n    }\n\n    handleSubplotDefaults(layoutIn, layoutOut, fullData, {\n        type: GL3D,\n        attributes: layoutAttributes,\n        handleDefaults: handleGl3dDefaults,\n        fullLayout: layoutOut,\n        font: layoutOut.font,\n        fullData: fullData,\n        getDfltFromLayout: getDfltFromLayout,\n        paper_bgcolor: layoutOut.paper_bgcolor,\n        calendar: layoutOut.calendar\n    });\n};\n\nfunction handleGl3dDefaults(sceneLayoutIn, sceneLayoutOut, coerce, opts) {\n    /*\n     * Scene numbering proceeds as follows\n     * scene\n     * scene2\n     * scene3\n     *\n     * and d.scene will be undefined or some number or number string\n     *\n     * Also write back a blank scene object to user layout so that some\n     * attributes like aspectratio can be written back dynamically.\n     */\n\n    var bgcolor = coerce('bgcolor');\n    var bgColorCombined = Color.combine(bgcolor, opts.paper_bgcolor);\n\n    var cameraKeys = ['up', 'center', 'eye'];\n\n    for(var j = 0; j < cameraKeys.length; j++) {\n        coerce('camera.' + cameraKeys[j] + '.x');\n        coerce('camera.' + cameraKeys[j] + '.y');\n        coerce('camera.' + cameraKeys[j] + '.z');\n    }\n\n    coerce('camera.projection.type');\n\n    /*\n     * coerce to positive number (min 0) but also do not accept 0 (>0 not >=0)\n     * note that 0's go false with the !! call\n     */\n    var hasAspect = !!coerce('aspectratio.x') &&\n                    !!coerce('aspectratio.y') &&\n                    !!coerce('aspectratio.z');\n\n    var defaultAspectMode = hasAspect ? 'manual' : 'auto';\n    var aspectMode = coerce('aspectmode', defaultAspectMode);\n\n    /*\n     * We need aspectratio object in all the Layouts as it is dynamically set\n     * in the calculation steps, ie, we cant set the correct data now, it happens later.\n     * We must also account for the case the user sends bad ratio data with 'manual' set\n     * for the mode. In this case we must force change it here as the default coerce\n     * misses it above.\n     */\n    if(!hasAspect) {\n        sceneLayoutIn.aspectratio = sceneLayoutOut.aspectratio = {x: 1, y: 1, z: 1};\n\n        if(aspectMode === 'manual') sceneLayoutOut.aspectmode = 'auto';\n\n        /*\n         * kind of like autorange - we need the calculated aspectmode back in\n         * the input layout or relayout can cause problems later\n         */\n        sceneLayoutIn.aspectmode = sceneLayoutOut.aspectmode;\n    }\n\n    var fullGl3dData = getSubplotData(opts.fullData, GL3D, opts.id);\n\n    supplyGl3dAxisLayoutDefaults(sceneLayoutIn, sceneLayoutOut, {\n        font: opts.font,\n        scene: opts.id,\n        data: fullGl3dData,\n        bgColor: bgColorCombined,\n        calendar: opts.calendar,\n        fullLayout: opts.fullLayout\n    });\n\n    Registry.getComponentMethod('annotations3d', 'handleDefaults')(\n        sceneLayoutIn, sceneLayoutOut, opts\n    );\n\n    var dragmode = opts.getDfltFromLayout('dragmode');\n\n    if(dragmode !== false) {\n        if(!dragmode) {\n            dragmode = 'orbit';\n\n            if(sceneLayoutIn.camera &&\n                sceneLayoutIn.camera.up) {\n                var x = sceneLayoutIn.camera.up.x;\n                var y = sceneLayoutIn.camera.up.y;\n                var z = sceneLayoutIn.camera.up.z;\n\n                if(z !== 0) {\n                    if(!x || !y || !z) {\n                        dragmode = 'turntable';\n                    } else if(z / Math.sqrt(x * x + y * y + z * z) > 0.999) {\n                        dragmode = 'turntable';\n                    }\n                }\n            } else {\n                dragmode = 'turntable';\n            }\n        }\n    }\n\n    coerce('dragmode', dragmode);\n    coerce('hovermode', opts.getDfltFromLayout('hovermode'));\n}\n"]},"metadata":{},"sourceType":"script"}