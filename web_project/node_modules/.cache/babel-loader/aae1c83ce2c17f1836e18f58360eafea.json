{"ast":null,"code":"/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../lib');\n\nvar EventEmitter = require('events').EventEmitter;\n\nvar helpers = require('./helpers');\n\nfunction svgToImg(opts) {\n  var ev = opts.emitter || new EventEmitter();\n  var promise = new Promise(function (resolve, reject) {\n    var Image = window.Image;\n    var svg = opts.svg;\n    var format = opts.format || 'png'; // IE only support svg\n\n    if (Lib.isIE() && format !== 'svg') {\n      var ieSvgError = new Error(helpers.MSG_IE_BAD_FORMAT);\n      reject(ieSvgError); // eventually remove the ev\n      //  in favor of promises\n\n      if (!opts.promise) {\n        return ev.emit('error', ieSvgError);\n      } else {\n        return promise;\n      }\n    }\n\n    var canvas = opts.canvas;\n    var scale = opts.scale || 1;\n    var w0 = opts.width || 300;\n    var h0 = opts.height || 150;\n    var w1 = scale * w0;\n    var h1 = scale * h0;\n    var ctx = canvas.getContext('2d');\n    var img = new Image();\n    var svgBlob, url;\n\n    if (format === 'svg' || Lib.isIE9orBelow() || Lib.isSafari()) {\n      url = helpers.encodeSVG(svg);\n    } else {\n      svgBlob = helpers.createBlob(svg, 'svg');\n      url = helpers.createObjectURL(svgBlob);\n    }\n\n    canvas.width = w1;\n    canvas.height = h1;\n\n    img.onload = function () {\n      var imgData;\n      svgBlob = null;\n      helpers.revokeObjectURL(url); // don't need to draw to canvas if svg\n      //  save some time and also avoid failure on IE\n\n      if (format !== 'svg') {\n        ctx.drawImage(img, 0, 0, w1, h1);\n      }\n\n      switch (format) {\n        case 'jpeg':\n          imgData = canvas.toDataURL('image/jpeg');\n          break;\n\n        case 'png':\n          imgData = canvas.toDataURL('image/png');\n          break;\n\n        case 'webp':\n          imgData = canvas.toDataURL('image/webp');\n          break;\n\n        case 'svg':\n          imgData = url;\n          break;\n\n        default:\n          var errorMsg = 'Image format is not jpeg, png, svg or webp.';\n          reject(new Error(errorMsg)); // eventually remove the ev\n          //  in favor of promises\n\n          if (!opts.promise) {\n            return ev.emit('error', errorMsg);\n          }\n\n      }\n\n      resolve(imgData); // eventually remove the ev\n      //  in favor of promises\n\n      if (!opts.promise) {\n        ev.emit('success', imgData);\n      }\n    };\n\n    img.onerror = function (err) {\n      svgBlob = null;\n      helpers.revokeObjectURL(url);\n      reject(err); // eventually remove the ev\n      //  in favor of promises\n\n      if (!opts.promise) {\n        return ev.emit('error', err);\n      }\n    };\n\n    img.src = url;\n  }); // temporary for backward compatibility\n  //  move to only Promise in 2.0.0\n  //  and eliminate the EventEmitter\n\n  if (opts.promise) {\n    return promise;\n  }\n\n  return ev;\n}\n\nmodule.exports = svgToImg;","map":{"version":3,"sources":["/Users/jingkaisu/Documents/HRfront/HalliganReviews/web_project/node_modules/plotly.js/src/snapshot/svgtoimg.js"],"names":["Lib","require","EventEmitter","helpers","svgToImg","opts","ev","emitter","promise","Promise","resolve","reject","Image","window","svg","format","isIE","ieSvgError","Error","MSG_IE_BAD_FORMAT","emit","canvas","scale","w0","width","h0","height","w1","h1","ctx","getContext","img","svgBlob","url","isIE9orBelow","isSafari","encodeSVG","createBlob","createObjectURL","onload","imgData","revokeObjectURL","drawImage","toDataURL","errorMsg","onerror","err","src","module","exports"],"mappings":"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","sourcesContent":["/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n\n'use strict';\n\nvar Lib = require('../lib');\nvar EventEmitter = require('events').EventEmitter;\n\nvar helpers = require('./helpers');\n\nfunction svgToImg(opts) {\n    var ev = opts.emitter || new EventEmitter();\n\n    var promise = new Promise(function(resolve, reject) {\n        var Image = window.Image;\n        var svg = opts.svg;\n        var format = opts.format || 'png';\n\n        // IE only support svg\n        if(Lib.isIE() && format !== 'svg') {\n            var ieSvgError = new Error(helpers.MSG_IE_BAD_FORMAT);\n            reject(ieSvgError);\n            // eventually remove the ev\n            //  in favor of promises\n            if(!opts.promise) {\n                return ev.emit('error', ieSvgError);\n            } else {\n                return promise;\n            }\n        }\n\n        var canvas = opts.canvas;\n        var scale = opts.scale || 1;\n        var w0 = opts.width || 300;\n        var h0 = opts.height || 150;\n        var w1 = scale * w0;\n        var h1 = scale * h0;\n\n        var ctx = canvas.getContext('2d');\n        var img = new Image();\n        var svgBlob, url;\n\n        if(format === 'svg' || Lib.isIE9orBelow() || Lib.isSafari()) {\n            url = helpers.encodeSVG(svg);\n        } else {\n            svgBlob = helpers.createBlob(svg, 'svg');\n            url = helpers.createObjectURL(svgBlob);\n        }\n\n        canvas.width = w1;\n        canvas.height = h1;\n\n        img.onload = function() {\n            var imgData;\n\n            svgBlob = null;\n            helpers.revokeObjectURL(url);\n\n            // don't need to draw to canvas if svg\n            //  save some time and also avoid failure on IE\n            if(format !== 'svg') {\n                ctx.drawImage(img, 0, 0, w1, h1);\n            }\n\n            switch(format) {\n                case 'jpeg':\n                    imgData = canvas.toDataURL('image/jpeg');\n                    break;\n                case 'png':\n                    imgData = canvas.toDataURL('image/png');\n                    break;\n                case 'webp':\n                    imgData = canvas.toDataURL('image/webp');\n                    break;\n                case 'svg':\n                    imgData = url;\n                    break;\n                default:\n                    var errorMsg = 'Image format is not jpeg, png, svg or webp.';\n                    reject(new Error(errorMsg));\n                    // eventually remove the ev\n                    //  in favor of promises\n                    if(!opts.promise) {\n                        return ev.emit('error', errorMsg);\n                    }\n            }\n            resolve(imgData);\n            // eventually remove the ev\n            //  in favor of promises\n            if(!opts.promise) {\n                ev.emit('success', imgData);\n            }\n        };\n\n        img.onerror = function(err) {\n            svgBlob = null;\n            helpers.revokeObjectURL(url);\n\n            reject(err);\n            // eventually remove the ev\n            //  in favor of promises\n            if(!opts.promise) {\n                return ev.emit('error', err);\n            }\n        };\n\n        img.src = url;\n    });\n\n    // temporary for backward compatibility\n    //  move to only Promise in 2.0.0\n    //  and eliminate the EventEmitter\n    if(opts.promise) {\n        return promise;\n    }\n\n    return ev;\n}\n\nmodule.exports = svgToImg;\n"]},"metadata":{},"sourceType":"script"}