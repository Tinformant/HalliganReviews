{"ast":null,"code":"/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar convert = require('./convert');\n\nvar LAYER_PREFIX = require('../../plots/mapbox/constants').traceLayerPrefix;\n\nvar ORDER = ['fill', 'line', 'circle', 'symbol'];\n\nfunction ScatterMapbox(subplot, uid) {\n  this.type = 'scattermapbox';\n  this.subplot = subplot;\n  this.uid = uid;\n  this.sourceIds = {\n    fill: 'source-' + uid + '-fill',\n    line: 'source-' + uid + '-line',\n    circle: 'source-' + uid + '-circle',\n    symbol: 'source-' + uid + '-symbol'\n  };\n  this.layerIds = {\n    fill: LAYER_PREFIX + uid + '-fill',\n    line: LAYER_PREFIX + uid + '-line',\n    circle: LAYER_PREFIX + uid + '-circle',\n    symbol: LAYER_PREFIX + uid + '-symbol'\n  }; // We could merge the 'fill' source with the 'line' source and\n  // the 'circle' source with the 'symbol' source if ever having\n  // for up-to 4 sources per 'scattermapbox' traces becomes a problem.\n  // previous 'below' value,\n  // need this to update it properly\n\n  this.below = null;\n}\n\nvar proto = ScatterMapbox.prototype;\n\nproto.addSource = function (k, opts) {\n  this.subplot.map.addSource(this.sourceIds[k], {\n    type: 'geojson',\n    data: opts.geojson\n  });\n};\n\nproto.setSourceData = function (k, opts) {\n  this.subplot.map.getSource(this.sourceIds[k]).setData(opts.geojson);\n};\n\nproto.addLayer = function (k, opts, below) {\n  this.subplot.addLayer({\n    type: k,\n    id: this.layerIds[k],\n    source: this.sourceIds[k],\n    layout: opts.layout,\n    paint: opts.paint\n  }, below);\n};\n\nproto.update = function update(calcTrace) {\n  var subplot = this.subplot;\n  var map = subplot.map;\n  var optsAll = convert(subplot.gd, calcTrace);\n  var below = subplot.belowLookup['trace-' + this.uid];\n  var i, k, opts;\n\n  if (below !== this.below) {\n    for (i = ORDER.length - 1; i >= 0; i--) {\n      k = ORDER[i];\n      map.removeLayer(this.layerIds[k]);\n    }\n\n    for (i = 0; i < ORDER.length; i++) {\n      k = ORDER[i];\n      opts = optsAll[k];\n      this.addLayer(k, opts, below);\n    }\n\n    this.below = below;\n  }\n\n  for (i = 0; i < ORDER.length; i++) {\n    k = ORDER[i];\n    opts = optsAll[k];\n    subplot.setOptions(this.layerIds[k], 'setLayoutProperty', opts.layout);\n\n    if (opts.layout.visibility === 'visible') {\n      this.setSourceData(k, opts);\n      subplot.setOptions(this.layerIds[k], 'setPaintProperty', opts.paint);\n    }\n  } // link ref for quick update during selections\n\n\n  calcTrace[0].trace._glTrace = this;\n};\n\nproto.dispose = function dispose() {\n  var map = this.subplot.map;\n\n  for (var i = ORDER.length - 1; i >= 0; i--) {\n    var k = ORDER[i];\n    map.removeLayer(this.layerIds[k]);\n    map.removeSource(this.sourceIds[k]);\n  }\n};\n\nmodule.exports = function createScatterMapbox(subplot, calcTrace) {\n  var trace = calcTrace[0].trace;\n  var scatterMapbox = new ScatterMapbox(subplot, trace.uid);\n  var optsAll = convert(subplot.gd, calcTrace);\n  var below = scatterMapbox.below = subplot.belowLookup['trace-' + trace.uid];\n\n  for (var i = 0; i < ORDER.length; i++) {\n    var k = ORDER[i];\n    var opts = optsAll[k];\n    scatterMapbox.addSource(k, opts);\n    scatterMapbox.addLayer(k, opts, below);\n  } // link ref for quick update during selections\n\n\n  calcTrace[0].trace._glTrace = scatterMapbox;\n  return scatterMapbox;\n};","map":{"version":3,"sources":["/Users/jingkaisu/Documents/HRfront/HalliganReviews/web_project/node_modules/plotly.js/src/traces/scattermapbox/plot.js"],"names":["convert","require","LAYER_PREFIX","traceLayerPrefix","ORDER","ScatterMapbox","subplot","uid","type","sourceIds","fill","line","circle","symbol","layerIds","below","proto","prototype","addSource","k","opts","map","data","geojson","setSourceData","getSource","setData","addLayer","id","source","layout","paint","update","calcTrace","optsAll","gd","belowLookup","i","length","removeLayer","setOptions","visibility","trace","_glTrace","dispose","removeSource","module","exports","createScatterMapbox","scatterMapbox"],"mappings":"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","sourcesContent":["/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n\n'use strict';\n\nvar convert = require('./convert');\nvar LAYER_PREFIX = require('../../plots/mapbox/constants').traceLayerPrefix;\nvar ORDER = ['fill', 'line', 'circle', 'symbol'];\n\nfunction ScatterMapbox(subplot, uid) {\n    this.type = 'scattermapbox';\n    this.subplot = subplot;\n    this.uid = uid;\n\n    this.sourceIds = {\n        fill: 'source-' + uid + '-fill',\n        line: 'source-' + uid + '-line',\n        circle: 'source-' + uid + '-circle',\n        symbol: 'source-' + uid + '-symbol'\n    };\n\n    this.layerIds = {\n        fill: LAYER_PREFIX + uid + '-fill',\n        line: LAYER_PREFIX + uid + '-line',\n        circle: LAYER_PREFIX + uid + '-circle',\n        symbol: LAYER_PREFIX + uid + '-symbol'\n    };\n\n    // We could merge the 'fill' source with the 'line' source and\n    // the 'circle' source with the 'symbol' source if ever having\n    // for up-to 4 sources per 'scattermapbox' traces becomes a problem.\n\n    // previous 'below' value,\n    // need this to update it properly\n    this.below = null;\n}\n\nvar proto = ScatterMapbox.prototype;\n\nproto.addSource = function(k, opts) {\n    this.subplot.map.addSource(this.sourceIds[k], {\n        type: 'geojson',\n        data: opts.geojson\n    });\n};\n\nproto.setSourceData = function(k, opts) {\n    this.subplot.map\n        .getSource(this.sourceIds[k])\n        .setData(opts.geojson);\n};\n\nproto.addLayer = function(k, opts, below) {\n    this.subplot.addLayer({\n        type: k,\n        id: this.layerIds[k],\n        source: this.sourceIds[k],\n        layout: opts.layout,\n        paint: opts.paint\n    }, below);\n};\n\nproto.update = function update(calcTrace) {\n    var subplot = this.subplot;\n    var map = subplot.map;\n    var optsAll = convert(subplot.gd, calcTrace);\n    var below = subplot.belowLookup['trace-' + this.uid];\n    var i, k, opts;\n\n    if(below !== this.below) {\n        for(i = ORDER.length - 1; i >= 0; i--) {\n            k = ORDER[i];\n            map.removeLayer(this.layerIds[k]);\n        }\n        for(i = 0; i < ORDER.length; i++) {\n            k = ORDER[i];\n            opts = optsAll[k];\n            this.addLayer(k, opts, below);\n        }\n        this.below = below;\n    }\n\n    for(i = 0; i < ORDER.length; i++) {\n        k = ORDER[i];\n        opts = optsAll[k];\n\n        subplot.setOptions(this.layerIds[k], 'setLayoutProperty', opts.layout);\n\n        if(opts.layout.visibility === 'visible') {\n            this.setSourceData(k, opts);\n            subplot.setOptions(this.layerIds[k], 'setPaintProperty', opts.paint);\n        }\n    }\n\n    // link ref for quick update during selections\n    calcTrace[0].trace._glTrace = this;\n};\n\nproto.dispose = function dispose() {\n    var map = this.subplot.map;\n\n    for(var i = ORDER.length - 1; i >= 0; i--) {\n        var k = ORDER[i];\n        map.removeLayer(this.layerIds[k]);\n        map.removeSource(this.sourceIds[k]);\n    }\n};\n\nmodule.exports = function createScatterMapbox(subplot, calcTrace) {\n    var trace = calcTrace[0].trace;\n    var scatterMapbox = new ScatterMapbox(subplot, trace.uid);\n    var optsAll = convert(subplot.gd, calcTrace);\n    var below = scatterMapbox.below = subplot.belowLookup['trace-' + trace.uid];\n\n    for(var i = 0; i < ORDER.length; i++) {\n        var k = ORDER[i];\n        var opts = optsAll[k];\n        scatterMapbox.addSource(k, opts);\n        scatterMapbox.addLayer(k, opts, below);\n    }\n\n    // link ref for quick update during selections\n    calcTrace[0].trace._glTrace = scatterMapbox;\n\n    return scatterMapbox;\n};\n"]},"metadata":{},"sourceType":"script"}